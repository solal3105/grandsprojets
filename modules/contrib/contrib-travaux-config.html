<!-- Travaux Configuration Section - Version simplifiée -->
<div id="travaux-config-section" style="display:none; margin-top:32px; padding-top:32px; border-top:2px solid var(--border-light);">
  
  <!-- Header avec collapse toggle -->
  <div id="travaux-config-header" style="display:flex; align-items:center; justify-content:space-between; padding:16px 20px; background:var(--gray-50); border-radius:12px; border:1px solid var(--border-light); cursor:pointer; transition:all 0.2s; margin-bottom:16px;">
    <div style="display:flex; align-items:center; gap:12px;">
      <div style="width:40px; height:40px; display:flex; align-items:center; justify-content:center; background:var(--warning-alpha-15); border-radius:10px;">
        <i class="fa-solid fa-helmet-safety" style="color:var(--warning); font-size:20px;"></i>
      </div>
      <div>
        <h3 style="margin:0; font-size:16px; font-weight:700; color:var(--text-primary);">Travaux</h3>
        <small style="font-size:12px; color:var(--text-secondary);">Configuration</small>
      </div>
    </div>
    <i id="travaux-collapse-icon" class="fa-solid fa-chevron-down" style="color:var(--text-tertiary); font-size:16px; transition:transform 0.3s;"></i>
  </div>

  <!-- Contenu collapsible -->
  <div id="travaux-config-content" style="display:none; background:var(--white); padding:24px; border-radius:12px; border:1px solid var(--border-light); box-shadow:0 2px 8px var(--black-alpha-05);">
    
    <!-- Activation avec Toggle Knob -->
    <div style="display:flex; align-items:center; justify-content:space-between; padding:16px 20px; background:var(--gray-50); border-radius:10px; margin-bottom:24px;">
      <div style="display:flex; align-items:center; gap:12px;">
        <i class="fa-solid fa-power-off" style="color:var(--text-secondary); font-size:18px;"></i>
        <div>
          <div style="font-weight:600; color:var(--text-primary); font-size:14px;">Activation</div>
          <small id="travaux-status-text" style="color:var(--text-tertiary); font-size:12px;">Catégorie désactivée</small>
        </div>
      </div>
      
      <!-- Toggle Knob -->
      <label class="travaux-toggle-knob" style="position:relative; display:inline-block; width:52px; height:28px; cursor:pointer;">
        <input type="checkbox" id="travaux-enabled-toggle" style="opacity:0; width:0; height:0;">
        <span class="travaux-toggle-slider" style="position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0; background:var(--gray-300); border-radius:28px; transition:all 0.3s; box-shadow:inset 0 2px 4px var(--black-alpha-10);"></span>
        <span class="travaux-toggle-knob-circle" style="position:absolute; content:''; height:22px; width:22px; left:3px; bottom:3px; background:var(--white); border-radius:50%; transition:all 0.3s; box-shadow:0 2px 4px var(--black-alpha-15);"></span>
      </label>
    </div>

    <!-- Contenu étendu (affiché seulement si activé) -->
    <div id="travaux-extended-content" style="display:none;">

    <!-- Source des données -->
    <div style="margin-bottom:24px;">
      <label style="display:block; font-size:13px; font-weight:600; color:var(--text-secondary); margin-bottom:12px; text-transform:uppercase; letter-spacing:0.5px;">
        Source des données
      </label>
      <div style="display:flex; flex-direction:column; gap:12px;">
        <label style="display:flex; align-items:start; gap:12px; cursor:pointer; padding:16px; border:2px solid var(--border-light); border-radius:8px; background:var(--white); transition:all 0.2s;">
          <input type="radio" name="travaux-source" value="url" id="travaux-source-url" style="width:18px; height:18px; cursor:pointer; margin-top:2px;" />
          <div style="flex:1;">
            <div style="font-weight:600; color:var(--text-primary); margin-bottom:4px;">URL externe (lecture seule)</div>
            <small style="color:var(--text-secondary); font-size:12px;">Les données viennent d'une URL GeoJSON. Pas de bouton "Ajouter".</small>
          </div>
        </label>
        <label style="display:flex; align-items:start; gap:12px; cursor:pointer; padding:16px; border:2px solid var(--border-light); border-radius:8px; background:var(--white); transition:all 0.2s;">
          <input type="radio" name="travaux-source" value="city_travaux" id="travaux-source-db" style="width:18px; height:18px; cursor:pointer; margin-top:2px;" checked />
          <div style="flex:1;">
            <div style="font-weight:600; color:var(--text-primary); margin-bottom:4px;">Base de données city_travaux (éditable)</div>
            <small style="color:var(--text-secondary); font-size:12px;">Les admins peuvent créer et modifier les chantiers.</small>
          </div>
        </label>
      </div>
    </div>

    <!-- URL (conditionnel) -->
    <div id="travaux-url-field" style="display:none; margin-bottom:24px;">
      <label for="travaux-url" style="display:block; font-size:13px; font-weight:600; color:var(--text-secondary); margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px;">
        URL du GeoJSON
      </label>
      <div style="display:flex; gap:8px; align-items:center;">
        <input type="url" id="travaux-url" placeholder="https://data.grandlyon.com/..." 
               style="flex:1; padding:12px 16px; border:1px solid var(--border-light); border-radius:8px; font-size:14px; font-family:monospace; background:var(--white);" />
        <i class="fa-solid fa-link" style="color:var(--text-tertiary); font-size:18px;"></i>
      </div>
      <small style="display:block; margin-top:6px; font-size:12px; color:var(--text-tertiary);">
        <i class="fa-solid fa-circle-info"></i> Cette URL sera utilisée pour charger les données
      </small>
    </div>

    <!-- Affichage -->
    <div style="margin-bottom:24px; padding-top:24px; border-top:1px solid var(--border-light);">
      <h4 style="margin:0 0 16px 0; font-size:14px; font-weight:600; color:var(--text-primary);">
        <i class="fa-solid fa-palette"></i> Affichage
      </h4>
      
      <div style="display:grid; grid-template-columns:1fr 120px; gap:16px;">
        <!-- Icône -->
        <div>
          <label for="travaux-icon" style="display:block; font-size:12px; font-weight:600; color:var(--text-secondary); margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px;">
            Icône
          </label>
          <div style="display:flex; gap:8px; align-items:stretch;">
            <input type="text" id="travaux-icon" value="fa-solid fa-helmet-safety" readonly
                   style="flex:1; padding:10px 12px; border:1px solid var(--border-light); border-radius:8px; font-size:13px; font-family:monospace; background:var(--gray-50); color:var(--text-secondary); cursor:pointer;" />
            <div id="travaux-icon-preview" style="width:56px; height:48px; display:flex; align-items:center; justify-content:center; border:2px solid var(--border-light); border-radius:8px; background:var(--white); font-size:24px; transition:all 0.2s; box-shadow:0 2px 8px var(--black-alpha-08);">
              <i class="fa-solid fa-helmet-safety" style="color:var(--text-primary);"></i>
            </div>
            <button type="button" id="travaux-icon-picker-btn" class="btn-secondary" 
                    style="white-space:nowrap; padding:10px 20px; border-radius:8px; font-weight:600; display:flex; align-items:center; gap:8px;">
              <i class="fa-solid fa-icons"></i> Choisir
            </button>
          </div>
        </div>

        <!-- Ordre -->
        <div>
          <label for="travaux-order" style="display:block; font-size:12px; font-weight:600; color:var(--text-secondary); margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px;">
            Ordre
          </label>
          <input type="number" id="travaux-order" value="5" min="0" step="1" 
                 style="width:100%; padding:10px 12px; border:1px solid var(--border-light); border-radius:8px; font-size:14px; text-align:center; background:var(--white);" />
        </div>
      </div>
    </div>

    <!-- Layers associés -->
    <div style="margin-bottom:24px; padding-top:24px; border-top:1px solid var(--border-light);">
      <label style="display:block; font-size:13px; font-weight:600; color:var(--text-secondary); margin-bottom:12px; text-transform:uppercase; letter-spacing:0.5px;">
        <i class="fa-solid fa-layer-group"></i> Layers à afficher (au clic sur Travaux)
      </label>
      <div id="travaux-layers-checkboxes" style="display:flex; flex-wrap:wrap; gap:8px; padding:12px; border:1px solid var(--border-light); border-radius:8px; background:var(--gray-50); min-height:60px;">
        <!-- Checkboxes peuplées dynamiquement -->
      </div>
      <small style="display:block; margin-top:8px; font-size:12px; color:var(--text-tertiary);">
        <i class="fa-solid fa-circle-info"></i> Sélectionnez les layers qui s'afficheront sur la carte au clic sur le menu Travaux.
      </small>
    </div>

    <!-- Actions -->
    <div style="display:flex; justify-content:flex-end; gap:12px; padding-top:20px; border-top:1px solid var(--border-light);">
      <button type="button" id="travaux-config-save" class="btn-primary" style="padding:12px 24px; font-weight:600;">
        <i class="fa-solid fa-floppy-disk"></i> Enregistrer
      </button>
    </div>
    
    </div><!-- Fin travaux-extended-content -->
  </div><!-- Fin travaux-config-content -->

  <!-- Statut -->
  <div id="travaux-config-status" style="display:none; margin-top:16px; padding:12px 16px; border-radius:8px; font-size:14px;"></div>
</div>

<!-- Styles pour le Toggle Knob -->
<style>
#travaux-enabled-toggle:checked + .travaux-toggle-slider {
  background: var(--primary);
}

#travaux-enabled-toggle:checked + .travaux-toggle-slider + .travaux-toggle-knob-circle {
  transform: translateX(24px);
}

#travaux-enabled-toggle:focus + .travaux-toggle-slider {
  box-shadow: 0 0 0 3px var(--primary-alpha-2);
}

.travaux-toggle-knob:hover .travaux-toggle-slider {
  opacity: 0.9;
}

#travaux-config-header:hover {
  background: var(--gray-100);
  border-color: var(--border);
}

#travaux-config-header.collapsed #travaux-collapse-icon {
  transform: rotate(0deg);
}

#travaux-config-header:not(.collapsed) #travaux-collapse-icon {
  transform: rotate(180deg);
}
</style>
