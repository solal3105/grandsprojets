<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Carte des grands projets d’urbanisme et de mobilité de la Métropole de Lyon: tram, projets urbains, travaux, voies lyonnaises... Dossiers, concertations et liens officiels.">
  <link rel="icon" type="image/png" href="/img/logomin.png" sizes="32x32">
  <title>Grands Projets de Lyon – Urbanisme et Mobilité</title>
  <link rel="canonical" href="https://grandsprojets.com/">
  <meta property="og:site_name" content="Grands Projets de Lyon">
  <meta property="og:locale" content="fr_FR">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Grands Projets de Lyon – Urbanisme et Mobilité">
  <meta property="og:description" content="Carte des grands projets d’urbanisme et de mobilité de la Métropole de Lyon: tram, projets urbains, travaux, voies lyonnaises... Dossiers, concertations et liens officiels.">
  <meta property="og:url" content="https://grandsprojets.com/">
  <meta property="og:image" content="https://grandsprojets.com/img/cover/meta.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Grands Projets de Lyon – Urbanisme et Mobilité">
  <meta name="twitter:description" content="Carte des grands projets d’urbanisme et de mobilité de la Métropole de Lyon: tram, projets urbains, travaux, voies lyonnaises... Dossiers, concertations et liens officiels.">
  <meta name="twitter:image" content="https://grandsprojets.com/img/cover/meta.png">
  <script type="application/ld+json" id="site-jsonld">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Grands Projets de Lyon",
    "url": "https://grandsprojets.com/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://grandsprojets.com/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  <script>
    (function() {
      try {
        var theme = (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) ? 'dark' : 'light';
        document.documentElement.setAttribute('data-theme', theme);
      } catch (e) {}
    })();
  </script>
  <link rel="stylesheet" href="style.css" />
  <!-- Chargement de Leaflet depuis des fichiers locaux -->
  <link rel="stylesheet" href="vendor/leaflet/leaflet.css">
  <link rel="stylesheet" href="ficheprojet.css">
  <!-- Font Awesome via cdnjs -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8LGDVJXTPK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());

    gtag('config', 'G-8LGDVJXTPK');
  </script>
</head>
<body>
  <!-- Standalone fixed logo for small screens -->
  <a class="mobile-fixed-logo" href="index.html" aria-label="Accueil">
    <img src="img/logo.svg" alt="Grands Projets de Lyon" />
  </a>
  <div id="container">
    <!-- Carte Leaflet -->
    <div id="map"></div>

    <!-- Barre de navigation -->
    <div id="left-nav">
      <div class="logo">
          <img src="img/logo.svg" alt="GrandsProjet.fr" />
        </div>
      <button class="nav-category" id="nav-transport">
        <i class="fa-solid fa-bus" aria-hidden="true"></i>
        <span class="label">transport</span>
      </button>
      <button class="nav-category" id="nav-velo">
        <i class="fa-solid fa-bicycle" aria-hidden="true"></i>
        <span class="label">vélo</span>
      </button>
      <button class="nav-category" id="nav-urbanisme">
        <i class="fa-solid fa-city" aria-hidden="true"></i>
        <span class="label">urbanisme</span>
      </button>
      <button class="nav-category" id="nav-travaux">
        <i class="fa-solid fa-person-digging" aria-hidden="true"></i>
        <span class="label">travaux</span>
      </button>
      <!-- Bouton contribution -->
      <button class="nav-category" id="nav-contribute" aria-label="Proposer une contribution" title="Proposer une contribution">
        <i class="fa-solid fa-plus" aria-hidden="true"></i>
        <span class="label">contribuer</span>
      </button>
      <!-- Sous-menus -->
      <div id="transport-submenu" class="submenu">
        <ul class="project-list" id="transport-project-list"></ul>
          </div>
      <div id="velo-submenu" class="submenu">
        <ul class="project-list" id="velo-project-list"></ul>
        </div>
      <div id="urbanisme-submenu" class="submenu">
        <ul class="project-list" id="urbanisme-project-list"></ul>
      </div>
      <div id="travaux-submenu" class="submenu" style="display:none">
        <ul class="project-list" id="travaux-project-list"></ul>
      </div>
  </div>

  <!-- Contribution modal -->
  <div id="contrib-overlay" class="gp-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="contrib-title" aria-hidden="true" style="display:none">
    <div class="gp-modal" role="document">
      <div class="gp-modal-header">
        <div class="gp-modal-title" id="contrib-title">Proposer une contribution</div>
        <button class="gp-modal-close" id="contrib-close" aria-label="Fermer">&times;</button>
      </div>
      <div class="gp-modal-body">
        <form id="contrib-form" class="contrib-form">
          <div class="form-row">
            <label for="contrib-project-name">Nom du projet</label>
            <input type="text" id="contrib-project-name" name="project_name" required placeholder="Ex: Tram T10 – Phase 2" />
          </div>

          <div class="form-row">
            <label for="contrib-category">Catégorie</label>
            <select id="contrib-category" name="category_layer" required>
              <option value="mobilite">Mobilité</option>
              <option value="urbanisme">Urbanisme</option>
              <option value="voielyonnaise">Voie Lyonnaise</option>
            </select>
          </div>

          <div class="form-row">
            <label for="contrib-geojson">Fichier GeoJSON</label>
            <input type="file" id="contrib-geojson" name="geojson_file" accept=".geojson,application/geo+json,application/json" required />
            <small>Fichier .geojson (ou .json au format GeoJSON).</small>
          </div>

          <div class="form-row">
            <label for="contrib-cover">Cover (optionnelle)</label>
            <input type="file" id="contrib-cover" name="cover_file" accept="image/png,image/jpeg,image/webp" />
            <small>Image .png, .jpg ou .webp. Elle sera stockée et son URL journalisée.</small>
          </div>

          <div class="form-row">
            <label for="contrib-meta">Meta (optionnel)</label>
            <input type="text" id="contrib-meta" name="meta" placeholder="Méta information (ex: tag, note, source)" />
          </div>

          <div class="form-row">
            <label for="contrib-description">Description (optionnelle)</label>
            <textarea id="contrib-description" name="description" rows="3" placeholder="Courte description du projet (ex: 1-3 phrases)"></textarea>
          </div>

          <div class="form-row">
            <label for="contrib-markdown">Contenu Markdown (optionnel)</label>
            <textarea id="contrib-markdown" name="markdown" rows="8" placeholder="# Titre\n\nDécrivez le projet, ajoutez des liens, etc."></textarea>
            <small>Le contenu sera stocké en Markdown dans le stockage et lié à votre contribution.</small>
          </div>

          <fieldset class="form-fieldset">
            <legend>Liens officiels (optionnels)</legend>
            <div class="form-row">
              <label for="contrib-grandlyon-url">Grand Lyon (urbanisme)</label>
              <input type="url" id="contrib-grandlyon-url" name="grandlyon_url" placeholder="https://..." />
            </div>
            <div class="form-row">
              <label for="contrib-sytral-url">SYTRAL (mobilité)</label>
              <input type="url" id="contrib-sytral-url" name="sytral_url" placeholder="https://..." />
            </div>
          </fieldset>

          <fieldset class="form-fieldset" id="contrib-docs">
            <legend>Dossiers de concertation (optionnels)</legend>
            <div class="doc-row">
              <input type="text" class="doc-title" placeholder="Titre du document PDF" />
              <input type="url" class="doc-url" placeholder="URL du PDF (https://...)" />
              <button type="button" class="doc-remove" aria-label="Supprimer" hidden>&times;</button>
            </div>
            <button type="button" id="contrib-doc-add" class="gp-btn gp-btn--secondary" style="margin-top:8px;">
              <i class="fa fa-plus" aria-hidden="true"></i>
              <span>Ajouter un document</span>
            </button>
          </fieldset>

          <div class="form-actions" style="margin-top:12px; display:flex; gap:8px; align-items:center;">
            <button type="submit" id="contrib-submit" class="gp-btn">
              <i class="fa fa-paper-plane" aria-hidden="true"></i>
              <span>Envoyer</span>
            </button>
            <div id="contrib-status" role="status" aria-live="polite" style="font-size:0.9em; opacity:0.8;"></div>
          </div>
        </form>
      </div>
    </div>
  </div>
      <div id="project-detail" class="project-detail">
        <div class="project-detail-header project-header-container">
          <button id="detail-back-btn" class="detail-back-btn">&larr; Retour</button>
           <h3 id="project-title" class="project-title">Titre du Projet</h3>
           <button id="detail-toggle-btn" style="display:none; color:grey;  border:none; cursor:pointer; margin:0 1rem;"><i class="fas fa-chevron-down"></i></button>
           <button id="detail-close-btn" class="detail-close-btn">✖</button>
        </div>
        <div id="detail-content" class="project-detail-content"></div>
      </div>
    </div>

    <!-- Barre de recherche d'adresse -->
    <div id="search-container" class="search-container">
      <button id="info-toggle" class="info-toggle" aria-label="À propos" title="À propos">
        <i class="fas fa-info-circle" aria-hidden="true"></i>
      </button>
      <button id="location-toggle" class="location-toggle" aria-label="Centrer sur ma position" title="Centrer sur ma position"
              onclick="window.GeolocationModule && window.GeolocationModule.handleLocationButtonClick(event)">
        <i class="fas fa-location-arrow"></i>
      </button>
      <div id="search-toggle" class="search-toggle">
        <i class="fas fa-search"></i>
      </div>
      <div id="search-overlay" class="search-overlay">
        <div class="search-bar">
          <input type="text" id="address-search" placeholder="Rechercher une adresse..." />
          <div id="search-results" class="search-results"></div>
        </div>
      </div>
    </div>

    <!-- Bouton de sélection du fond de carte -->
    <div id="theme-toggle" class="theme-toggle" role="button" tabindex="0" aria-pressed="false" title="Mode sombre">
      <i class="fas fa-moon"></i>
    </div>
    <div id="basemap-toggle" class="basemap-toggle">
      <i class="fas fa-globe"></i>
    </div>
    <!-- Menu des fonds de carte en mode tuile -->
    <div id="basemap-menu" class="basemap-menu"></div>

    <!-- Zone de filtres -->
    <div id="filters-toggle" class="filters-toggle">
      <i class="fas fa-map"></i>
      <span class="filter-count">0</span>
    </div>
    <!-- Contenu des filtres -->
    <div id="filters-container" style="display: none">
      <div id="dynamic-filters"></div>
      <button id="reset-all-filters">Réinitialiser tous les filtres</button>
    </div>
  </div>

  <!-- À propos modal -->
  <div id="about-overlay" class="gp-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="about-title" aria-hidden="true" style="display:none">
    <div class="gp-modal" role="document">
      <div class="gp-modal-header">
        <div class="gp-modal-title" id="about-title">À propos de GrandsProjets.com</div>
        <button class="gp-modal-close" id="about-close" aria-label="Fermer">&times;</button>
      </div>
      <div class="gp-modal-body">
        <div class="about-content">
          <section class="about-text markdown-body">
            <p>Salut 👋 Moi c’est <strong>Solal Gendrin</strong>, Villeurbannais de cœur, passionné par la ville et ses transformations.</p>
            <p>J’ai créé <strong>GrandsProjets.com</strong> pour montrer, sans jargon, ce qui se construit dans la métropole de Lyon.</p>

            <h2>🚧 Pourquoi ce site</h2>
            <p>À Lyon, les travaux sont partout : rues bloquées, tramways en chantier, immeubles qui sortent de terre.</p>
            <p>Mais il reste difficile de savoir ce qui est prévu, pourquoi et jusqu’à quand.</p>
            <p>Ce site met tout sur une carte : nouvelles lignes de tram, Voies Lyonnaises, réaménagements de quartiers.</p>
            <p>L’idée est simple : permettre à chacun de voir rapidement ce qui se passe autour de chez lui.</p>

            <h2>🙋‍♂️ Qui je suis</h2>
            <p>Je ne représente aucune institution.</p>
            <p>Je suis product manager de métier et passionné d’urbanisme.</p>
            <p>J’ai rassemblé des données publiques et je les ai organisées pour les rendre accessibles à tous.</p>
          </section>
          <section class="about-sidebar">
            <h2>✉️ Me contacter</h2>
            <p class="about-note">Une remarque, une info, ou juste envie d’échanger ?</p>
            <div class="contact-cards">
              <a class="contact-card" href="mailto:solal.gendrin@gmail.com">
                <span class="contact-icon"><i class="fas fa-envelope" aria-hidden="true"></i></span>
                <div class="contact-meta">
                  <div class="contact-title">Email</div>
                  <div class="contact-sub">solal.gendrin@gmail.com</div>
                </div>
              </a>
              <a class="contact-card" href="https://www.linkedin.com/in/solal-gendrin/" target="_blank" rel="noopener">
                <span class="contact-icon"><i class="fab fa-linkedin-in" aria-hidden="true"></i></span>
                <div class="contact-meta">
                  <div class="contact-title">LinkedIn</div>
                  <div class="contact-sub">Solal Gendrin</div>
                </div>
              </a>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>

  <!-- Supabase client via CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"></script>
  <script src="modules/auth.js"></script>
  <!-- Chargement de Leaflet JS depuis des fichiers locaux -->
  <script src="vendor/leaflet/leaflet.js"></script>
  <!-- Marked via jsDelivr -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- Chargement des scripts locaux -->
   
  <script src="modules/supabaseservice.js"></script>
  <script src="modules/mapmodule.js"></script>
  <script src="modules/filtermodule.js"></script>
  <script src="modules/datamodule.js"></script>
  <script src="modules/uimodule.js"></script>
  <script src="modules/searchmodule.js"></script>
  <script src="modules/geolocation.js"></script>
  <script src="modules/navigationmodule.js"></script>
  <script src="modules/eventbindings.js"></script>
  <script src="modules/contrib.js"></script>
  <script src="main.js"></script>
</body>
</html>
